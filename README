  INTRODUCTION

Www.world-airport-codes.com offers a list of all airport codes. Unfortunatly,
they don't offer a convenient way of downloading it. That is why we wrote this
collection of scripts. Additionally, we made scripts that links each airport to
a specific geological location, from the database from www.geonames.org. And
because we needed the dutch name of both the city and the country the airport
was in, we included that in the table as well.

These scripts were originally not intended for release (but were released upon
request anyway), so don't complain about the mess :)



  SOFTWARE REQUIREMENTS

- MySQL database (only needed when collecting the geonames info)
- Ruby
- Ruby gem scrapi
- Ruby gem htmlentities
- PHP (version 5 probably)



  USAGE

Usage is quite complicated, because it originally wasn't intended to be
distributed. Hopefully it will all become clear.

First you're going to have to run the airport code scraper. Simply do this by
running "ruby www.world-airport-codes.com-scraper.rb". It outputs to standard
out, so you have to redirect it's output, which will be a csv file. An already
scraped version of this csv file is included (www.world-airport-codes.com.csv).
The scraping can take quite a while. 

If you're not interested in the geoname data, you're done now. You have a csv
full of airport code data.

Then, if you're interested in the geonames data, you need to create a MySQL
database. Enter the database connection properties in "db-connection.php", as
development database. Don't forget to choose the correct character encoding
command! 

Then you need to load the database structure. This step is a bit complex. Load
the files 001_* and 002* into your database by hand with the command 
"mysql --user=user --password=password --host=host databasename < mysql-commands.mysql" 
(run it once for 001_... and then for 002_...).  Then, run 
"php migrate.php". If all goes well, it should perform all the changes to the
database to arrive at the version we ended up using. For more information about
the migration script, go to http://www.halfgaar.net/mysql-migrations. I
recommend you use a database on the localhost, otherwise it will be very very
slow.

The geoname data files can be downloaded at:
http://download.geonames.org/export/dump/. You need allCountries.zip and
alternateNames.zip. The specification of the data fields can be found there as
well.

Then you may want to run the "filter-geonames.rb" script, to remove everything
from these csv files you don't need. For me, it meant going from a 700MB csv
file, to a 250 MB one, so it was worth it.

Then load the airport codes csv file into the database. This is done with the
php script reload_airport_data_into_db.php.

The next step is to run the geo_names_extractor.php script, which gives each
airport a city_name_geo_name_id or country_name_geo_name_id. It also sets the
Dutch city and country names for each airport.

When this is all done, you have a database full of useful information. If you
want this in a csv file, you can use the script dump_airport_data_from_db.php
to dump the database contents to CSV.



  ADDITIONAL INFORMATION

Also read the introductory comment in each script for more details about it.
They might say a bit more than this README file does.



  AIRPORT COORDINATES

We found that a lot of airports in the airport codes database don't have proper
coordinates (some are in the middle of the sea...). This is partly because
obscure airports, like helipads, are listed, of which nobody really confirmed
the coordinates, I guess. If you want (more) reliable ones, use the ones from
the geonames data (although you will have the coordinates of the city, not the
airfield). If you did everything I mentioned in this script, they can be found
in the "cities" table in your database. Simply do a join based on the
city_name_geo_name_id between cities and airport_codes.



  BUGS/PROBLEMS

Should there be any problems, you can contact Wiebe Cazemier (wiebe@halfgaar.net). 



  AUTHORS

Wiebe Cazemier (http://www.halfgaar.net, wiebe@halfgaar.net) 
Rowan Rodrik van der Molen

